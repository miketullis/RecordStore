@model IEnumerable<RecordStore.Data.EF.Album>
@*@model PagedList.IPagedList<RecordStore.Data.EF.Album>
@using PagedList.Mvc*@

@{
    ViewBag.Title = "Products";
}

<div id="rrWrapper">

@*-----Initially coded with paged list, but opted to use a DataTable layout inseat for added functionality ----- *@
    @*Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount
        @Html.PagedListPager(Model, page => Url.Action("Index", new { page }))
        @using (Html.BeginForm("Index", "Album", FormMethod.Get))
        {
            <p style="padding-bottom: 1em;">
                <input type="text" name="searchString" style="max-width:250px;" />
                <input type="submit" value="Search" />

                @if (User.IsInRole("Admin"))
                {
                    @Html.ActionLink("Add A New Album", "Create")
                }
            </p>
        }*@

    @if (User.IsInRole("Admin"))
    {
        @Html.ActionLink("Add A New Album", "Create")
    }



    @* we can only show the table if there are results, otherwise show text asking the use to try again *@

    @if (Model.Count() > 0)
    {
        <table class="table" id="myTable">
            <thead>
                <tr>
                    <th>
                        @*@Html.DisplayNameFor(model => model.FirstOrDefault().AlbumImage)*@
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.FirstOrDefault().AlbumName)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.FirstOrDefault().ReleaseYear)
                    </th>
                    @*<th>
                            @Html.DisplayNameFor(model => model.Description)
                        </th>*@
                    @*<th>
                            @Html.DisplayNameFor(model => model.CompilationAlbum)
                        </th>*@

                    <th>
                        @Html.DisplayNameFor(model => model.FirstOrDefault().Price)
                    </th>
                    @*<th>
                            @Html.DisplayNameFor(model => model.IsInPrint)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.UnitsInStock)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Num)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.AlbumStatus.AlbumStatusName)
                        </th>*@
                    <th>
                        @Html.DisplayNameFor(model => model.FirstOrDefault().Format.FormatType)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.FirstOrDefault().Label.LabelName)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.FirstOrDefault().CatalogNum)
                    </th>

                    @*<th>
                            @Html.DisplayNameFor(model => model.FirstOrDefault().GenreName)
                        </th>*@

                    @if (User.IsInRole("Admin"))
                    {
                        <th></th>
                    }

                </tr>
            </thead>

            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @*@Html.DisplayFor(modelItem => item.AlbumImage)*@

                            <a href="@Url.Action("Details", new { id = item.AlbumID })">
                                <img src="~/Content/assets/images/albumImages/t_@item.AlbumImage" alt="@item.AlbumName cover" title="@item.AlbumName cover" id="albumArt" />
                            </a>
                        </td>
                        <td>
                            <a href="@Url.Action("Details", new { id = item.AlbumID })" style="font-weight:bold; color: black;">
                                @Html.DisplayFor(modelItem => item.AlbumName)
                            </a>
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.ReleaseYear)
                        </td>

                        @*<td>
                                @Html.DisplayFor(modelItem => item.Description)
                            </td>*@
                        @*<td>
                                @Html.DisplayFor(modelItem => item.CompilationAlbum)
                            </td>*@

                        <td>
                            @Html.DisplayFor(modelItem => item.Price)
                        </td>
                        @*<td>
                                @Html.DisplayFor(modelItem => item.IsInPrint)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.UnitsInStock)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Num)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.AlbumStatus.AlbumStatusName)
                            </td>*@
                        <td>
                            @Html.DisplayFor(modelItem => item.Format.FormatType)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Label.LabelName)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.CatalogNum)
                        </td>
                        @*<td>
                                @Html.DisplayFor(modelItem => item.GenreName)
                            </td>*@

                        @if (User.IsInRole("Admin"))
                        {
                            <td>
                                @Html.ActionLink("Edit", "Edit", new { id = item.AlbumID }) |
                                @Html.ActionLink("Details", "Details", new { id = item.AlbumID }) |
                                @Html.ActionLink("Delete", "Delete", new { id = item.AlbumID })
                            </td>
                        }
                    </tr>
                }
            </tbody>
        </table>

    }
    else
    {
        <p> Your search result did not return any results. Please try again or hit "Search" again to refresh.</p>
    }
</div>

@section Scripts{
    <script>
        $(document).ready(function () {
            $('#myTable').DataTable();
        });
    </script>
}
